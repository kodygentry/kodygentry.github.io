<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kody Gentry Portfolio</title>
    <!-- Font imports for Dark Desert Modernism aesthetic -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      /* Card populate-in animation */
      @keyframes card-pop-in {
        0% {
          opacity: 0;
          transform: translateY(32px) scale(0.98);
          filter: blur(6px);
        }
        80% {
          opacity: 1;
          transform: translateY(-4px) scale(1.01);
          filter: blur(0px);
        }
        100% {
          opacity: 1;
          transform: none;
          filter: none;
        }
      }
      .card-pop-in {
        animation: card-pop-in 0.7s cubic-bezier(0.22, 0.68, 0.43, 1.01) both;
      }
      /* Tab content fade and slide animations */
      @keyframes tab-fade-in {
        0% {
          opacity: 0;
          transform: translateY(12px);
          filter: blur(4px);
        }
        100% {
          opacity: 1;
          transform: translateY(0);
          filter: blur(0);
        }
      }
      @keyframes tab-fade-out {
        0% {
          opacity: 1;
          transform: translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateY(-12px);
          filter: blur(4px);
        }
      }
      .tab-content {
        animation: tab-fade-in 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      }
      .tab-content.fade-out {
        animation: tab-fade-out 0.3s cubic-bezier(0.3, 0, 0.8, 0.15) forwards;
      }
      /* Tab button active animation */
      @keyframes tab-bg-expand {
        0% {
          background: rgba(74, 90, 127, 0.2);
        }
        50% {
          background: rgba(74, 90, 127, 0.35);
        }
        100% {
          background: rgba(74, 90, 127, 0.2);
        }
      }
      .tabs button.active {
        animation: tab-bg-expand 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      }
      /* Reset styles and base typography */
      *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI',
          sans-serif;
        color: #f0f0f0;
        background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 50%, #141820 100%);
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
        font-weight: 400;
        letter-spacing: 0.4px;
        line-height: 1.6;
      }
      body.no-scroll {
        overflow: hidden;
      }
      /* Dot-dither starfield */
      body::before {
        content: '';
        position: absolute;
        inset: 0;
        background-image: radial-gradient(rgba(240, 240, 240, 0.08) 1px, transparent 1px);
        background-size: 4px 4px;
        opacity: 0.5;
        mix-blend-mode: screen;
        pointer-events: none;
      }
      /* Horizon grid (reminiscent of retro CRT floor) */
      body::after {
        content: '';
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        height: 40vh;
        perspective: 800px;
        pointer-events: none;
      }
      body::after::before {
        content: '';
        position: absolute;
        inset: 0;
        transform-origin: bottom;
        transform: rotateX(60deg);
        background-image: linear-gradient(rgba(240, 240, 240, 0.04) 1px, transparent 1px),
          linear-gradient(90deg, rgba(240, 240, 240, 0.04) 1px, transparent 1px);
        background-size: 40px 40px;
        pointer-events: none;
      }
      /* Layout container */
      .container {
        max-width: 960px;
        margin: 0 auto;
        padding: 2rem 1rem 4rem;
      }
      /* Hero card styling */
      .hero-card {
        position: relative;
        margin: 0 auto 2rem;
        padding: 2rem;
        border-radius: 1.5rem;
        border: 2px solid #4a5a7f;
        background: linear-gradient(
          135deg,
          rgba(26, 31, 46, 0.95) 0%,
          rgba(32, 40, 60, 0.98) 100%
        );
        box-shadow: 0 8px 32px rgba(74, 90, 127, 0.1), inset 0 1px 0 rgba(240, 240, 240, 0.1);
        overflow: hidden;
      }
      .hero-card-animated-bg {
        position: absolute;
        inset: 0;
        z-index: 0;
        border-radius: inherit;
        pointer-events: none;
        background: linear-gradient(
          120deg,
          #38bdf8 0%,
          #64748b 40%,
          #e0e7ef 80%,
          #ffffff 100%
        );
        opacity: 0.38;
        filter: blur(32px) brightness(1.2) saturate(1.1);
        animation: wave-gradient 3.5s cubic-bezier(0.4, 0.2, 0.6, 0.8) infinite alternate;
        background-size: 200% 200%;
      }
      .hero-card-animated-bg::after {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        pointer-events: none;
        z-index: 1;
        opacity: 1;
        mix-blend-mode: normal;
        background-image: url('https://www.transparenttextures.com/patterns/noise.png'),
          url('https://www.transparenttextures.com/patterns/noise.png'),
          url('https://www.transparenttextures.com/patterns/noise.png'),
          url('https://www.transparenttextures.com/patterns/noise.png');
        background-size: 16px 16px, 8px 8px, 4px 4px, 2px 2px;
        background-blend-mode: normal, normal, normal, normal;
      }
      @keyframes wave-gradient {
        0% {
          background-position: 0% 50%;
        }
        33% {
          background-position: 100% 30%;
        }
        66% {
          background-position: 50% 100%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      .hero-card::before {
        content: '';
        position: absolute;
        inset: -4px;
        border-radius: inherit;
        background: linear-gradient(
          135deg,
          rgba(6, 182, 212, 0.4),
          rgba(79, 70, 229, 0.4),
          rgba(99, 102, 241, 0.4)
        );
        z-index: -1;
        filter: blur(20px);
      }
      .hero-icons {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 1rem;
      }
      .hero-icons div {
        width: 2.5rem;
        height: 2.5rem;
        display: grid;
        place-items: center;
        border-radius: 0.75rem;
        border: 1px solid rgba(74, 90, 127, 0.35);
        background: rgba(74, 90, 127, 0.15);
        backdrop-filter: blur(10px) saturate(1.2);
        box-shadow: 0 2px 8px rgba(74, 90, 127, 0.1);
      }
      .hero-card h1 {
        font-size: clamp(2.5rem, 10vw, 4.5rem);
        font-weight: 700;
        color: #ffffff;
        letter-spacing: -1px;
        text-align: center;
        font-family: 'Space Grotesk', sans-serif;
        line-height: 1;
        text-transform: uppercase;
        margin-bottom: 0.5rem;
      }
      .hero-card p {
        text-align: center;
        margin-top: 0.5rem;
        color: #c0c0c0;
        font-weight: 400;
        letter-spacing: 1px;
        text-transform: uppercase;
        font-size: 0.8rem;
      }
      .hero-links {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 1.5rem;
      }
      .hero-links a {
        padding: 0.5rem 1.25rem;
        border-radius: 9999px;
        background: rgba(74, 90, 127, 0.15);
        color: #ffffff;
        text-decoration: none;
        border: 1.5px solid #4a5a7f;
        backdrop-filter: blur(8px) saturate(1.2);
        box-shadow: 0 2px 8px rgba(74, 90, 127, 0.08);
        transition: background 0.2s, transform 0.2s;
        font-weight: 600;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        font-size: 0.75rem;
      }
      .hero-links a:hover {
        background: rgba(74, 90, 127, 0.25);
        transform: translateY(-2px);
      }
      /* Tabs bar */
      .tabs {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        margin-bottom: 2rem;
        border-radius: 1rem;
        background: rgba(74, 90, 127, 0.08);
        overflow: hidden;
        backdrop-filter: blur(8px) saturate(1.2);
        box-shadow: 0 2px 8px rgba(74, 90, 127, 0.08);
        border: 1px solid rgba(74, 90, 127, 0.15);
      }
      .tabs button {
        padding: 0.75rem;
        color: #e0e0e0;
        background: transparent;
        border: none;
        font-size: 0.75rem;
        cursor: pointer;
        transition: background 0.2s, color 0.2s;
        border-right: 1px solid rgba(74, 90, 127, 0.1);
        backdrop-filter: none;
        font-weight: 600;
        letter-spacing: 0.7px;
        text-transform: uppercase;
      }
      .tabs button:last-child {
        border-right: none;
      }
      .tabs button.active {
        background: rgba(74, 90, 127, 0.2);
        color: #ffffff;
        font-weight: 700;
        backdrop-filter: blur(2px);
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      /* Accordion styling */
      .accordion {
        border-top: 1px solid rgba(74, 90, 127, 0.15);
      }
      .accordion details {
        border-bottom: 1px solid rgba(74, 90, 127, 0.15);
      }
      .accordion summary {
        display: flex;
        justify-content: space-between;
        padding: 1rem;
        cursor: pointer;
        color: #a8bce0;
        font-weight: 700;
        transition: background 0.2s;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        font-size: 0.75rem;
      }
      .accordion details[open] summary {
        background: rgba(74, 90, 127, 0.08);
      }
      .accordion details summary::after {
        content: '\25be';
        transition: transform 0.3s;
      }
      .accordion details[open] summary::after {
        transform: rotate(180deg);
      }
      /* Grid for cards */
      .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }
      .project-card,
      .game-card {
        position: relative;
        border-radius: 1rem;
        border: 1.5px solid rgba(74, 90, 127, 0.2);
        background: linear-gradient(
          135deg,
          rgba(26, 31, 46, 0.7) 0%,
          rgba(32, 40, 60, 0.7) 100%
        );
        padding: 1rem;
        box-shadow: 0 4px 12px rgba(74, 90, 127, 0.08), inset 0 1px 0 rgba(240, 240, 240, 0.1);
        transition: transform 0.15s, box-shadow 0.2s, background 0.2s, border 0.2s;
        overflow: hidden;
      }
      .project-card-highlight {
        border: 2px solid #4a5a7f;
        background: linear-gradient(
          120deg,
          rgba(74, 90, 127, 0.15) 0%,
          rgba(74, 90, 127, 0.1) 100%
        );
        box-shadow: 0 0 0 1px #4a5a7f1a, 0 4px 16px rgba(74, 90, 127, 0.12);
      }
      .project-card::before,
      .game-card::before {
        content: '';
        position: absolute;
        inset: -3px;
        border-radius: inherit;
        z-index: 1;
        opacity: 0;
        pointer-events: none;
        background: linear-gradient(
          120deg,
          #38bdf8 0%,
          #64748b 40%,
          #e0e7ef 80%,
          #ffffff 100%
        );
        filter: blur(8px) brightness(1.05) saturate(1.05);
        background-size: 200% 200%;
        transition: opacity 0.25s;
      }
      .project-card:hover::before,
      .game-card:hover::before {
        opacity: 0.45;
        animation: wave-gradient 3.5s cubic-bezier(0.4, 0.2, 0.6, 0.8) infinite alternate;
      }
      .project-card:hover,
      .game-card:hover {
        transform: translateY(-3px);
        z-index: 2;
        border-color: #4a5a7f;
        background: linear-gradient(
          135deg,
          rgba(40, 50, 75, 0.9) 0%,
          rgba(50, 65, 100, 0.9) 100%
        );
      }
      .project-card h3,
      .game-card h3 {
        font-size: 1rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: #ffffff;
        transition: color 0.2s;
        font-family: 'Space Grotesk', sans-serif;
        letter-spacing: 0.3px;
        text-transform: uppercase;
      }
      .project-card p,
      .game-card p {
        font-size: 0.8rem;
        color: #c0c0c0;
        margin-bottom: 0.5rem;
        transition: color 0.2s;
        font-weight: 400;
        line-height: 1.6;
        letter-spacing: 0.2px;
      }
      .project-card:hover h3,
      .game-card:hover h3,
      .project-card:hover p,
      .game-card:hover p,
      .project-card:hover .project-meta,
      .game-card:hover .project-meta {
        color: #ffffff !important;
      }
      .project-meta {
        font-size: 0.75rem;
        display: flex;
        gap: 0.75rem;
        margin-top: 0.5rem;
      }
      .project-meta span {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
      }
      .project-meta a {
        color: #a8bce0;
        text-decoration: underline;
        font-weight: 600;
        letter-spacing: 0.2px;
      }

      /* Welcome screen overlay */
      #welcome-screen {
        position: fixed;
        inset: 0;
        z-index: 999;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(circle at top, #1f2933 0%, #050816 55%, #020617 100%);
        color: #e5e7eb;
        overflow: hidden;
        opacity: 1;
        transition: opacity 0.35s ease-out, transform 0.35s cubic-bezier(0.2, 1.6, 0.4, 1.1);
      }
      #welcome-screen::before {
        content: '';
        position: absolute;
        inset: 0;
        background-image: radial-gradient(rgba(248, 250, 252, 0.12) 1px, transparent 1px);
        background-size: 4px 4px;
        mix-blend-mode: screen;
        opacity: 0.7;
        pointer-events: none;
      }
      .welcome-shell {
        position: relative;
        display: inline-flex;
        flex-direction: column;
        align-items: stretch;
        gap: 0.75rem;
        animation: welcome-shell-pop 1.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      }
      .welcome-text {
        font-size: clamp(2.8rem, 9vw, 4rem);
        letter-spacing: 0.4em;
        text-transform: uppercase;
        text-align: center;
        color: #f9fafb;
        font-weight: 700;
        animation: welcome-text-flicker 3.6s ease-in-out 0.4s infinite;
      }
      .welcome-bar {
        position: relative;
        width: 100%;
        height: 3px;
        border-radius: 999px;
        background: rgba(148, 163, 184, 0.35);
        overflow: hidden;
      }
      .welcome-bar-fill {
        position: absolute;
        inset: 0;
        transform-origin: left;
        transform: scaleX(0);
        background: linear-gradient(90deg, #38bdf8, #a855f7, #f97316);
        animation: welcome-bar-fill 3s ease-out forwards;
      }
      #welcome-screen.welcome-out {
        opacity: 0;
        transform: scale(1.2) translateY(-32px) rotate(1deg);
      }
      #welcome-screen.welcome-out .welcome-text {
        transform: scale(1.35) translateY(-10px);
      }
      @keyframes welcome-shell-pop {
        0% {
          opacity: 0;
          transform: scale(1.35) translateY(18px);
        }
        60% {
          opacity: 1;
          transform: scale(0.88) translateY(-6px);
        }
        100% {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }
      @keyframes welcome-text-flicker {
        0%, 82%, 100% {
          text-shadow: 0 0 0 rgba(248, 250, 252, 0.2);
        }
        84% {
          text-shadow: 0 0 8px rgba(248, 250, 252, 0.7);
        }
        88% {
          text-shadow: 0 0 2px rgba(248, 250, 252, 0.3);
        }
        92% {
          text-shadow: 0 0 14px rgba(248, 250, 252, 0.85);
        }
      }
      @keyframes welcome-bar-fill {
        0% {
          transform: scaleX(0);
        }
        100% {
          transform: scaleX(1);
        }
      }
    </style>
  </head>
  <body class="no-scroll">
    <!-- Welcome screen overlay -->
    <div id="welcome-screen">
      <div class="welcome-shell">
        <div class="welcome-text">WELCOME</div>
        <div class="welcome-bar"><div class="welcome-bar-fill"></div></div>
      </div>
    </div>

    <main class="container">
      <!-- Hero section -->
      <section class="hero-card">
        <div class="hero-card-animated-bg"></div>
        <div class="hero-icons">
          <div>
            <i class="fa-solid fa-gamepad" style="font-size: 1.3rem; color: #a8bce0"></i>
          </div>
          <div>
            <i class="fa-solid fa-code" style="font-size: 1.3rem; color: #a8bce0"></i>
          </div>
          <div>
            <i class="fa-solid fa-palette" style="font-size: 1.3rem; color: #a8bce0"></i>
          </div>
        </div>
        <h1>Kody Gentry</h1>
        <p>Software ¬∑ Game Dev ¬∑ Art</p>
        <p>Founder of Chum Studios</p>
        <div class="hero-links">
          <a href="https://github.com/kodygentry" target="_blank" rel="noopener">GitHub</a>
          <a href="mailto:kodygentry3737@gmail.com">Email</a>
          <a href="static/assets/KodyGentryResume.pdf" download>Resume</a>
        </div>
      </section>
      <!-- Tabs bar -->
      <nav class="tabs" role="tablist">
        <button id="tab-software" class="active" role="tab" aria-selected="true">
          Software
        </button>
        <button id="tab-games" role="tab" aria-selected="false">Games</button>
        <button id="tab-art" role="tab" aria-selected="false">3D / Art</button>
      </nav>
      <!-- Tab contents -->
      <section
        id="content-software"
        class="tab-content active"
        aria-labelledby="tab-software"
      >
        <div class="accordion">
          <details>
            <summary>Side projects</summary>
            <div class="card-grid" id="side-projects"></div>
          </details>
          <details>
            <summary>School projects</summary>
            <div class="card-grid" id="school-projects"></div>
          </details>
          <details>
            <summary>Game dev (code repos)</summary>
            <div class="card-grid" id="game-projects"></div>
          </details>
        </div>
      </section>
      <section id="content-games" class="tab-content" aria-labelledby="tab-games">
        <div class="card-grid" id="game-cards"></div>
      </section>
      <section id="content-art" class="tab-content" aria-labelledby="tab-art">
        <div class="game-card">
          <h3>3D Props &amp; Environments</h3>
          <p>Assorted low-poly props and moody environment studies.</p>
          <strong>Work in progress!</strong>
          <p class="project-meta"><span>Tools:</span> Blender, Game Art</p>
        </div>
        <div class="card-grid" style="margin-top: 1.2rem">
          <div class="game-card">
            <img
              src="static/assets/img.png"
              alt="Chum Studios"
              style="
                width: 100%;
                height: 160px;
                object-fit: contain;
                border-radius: 0.5rem;
                margin-bottom: 0.5rem;
                background: #2a3347;
              "
            />
            <h3>Chum Studios</h3>
            <p>Studio logo and branding.</p>
          </div>
          <div class="game-card">
            <img
              src="static/assets/seths_logo.png"
              alt="Fan Art - Seth's Logo"
              style="
                width: 100%;
                height: 160px;
                object-fit: contain;
                border-radius: 0.5rem;
                margin-bottom: 0.5rem;
                background: #2a3347;
              "
            />
            <h3>Seth's Logo</h3>
            <p>Alternate Chum Studios Logo</p>
          </div>
        </div>
      </section>
    </main>
    <footer
      style="
        text-align: center;
        padding: 1rem 0;
        font-size: 0.75rem;
        color: #707070;
        letter-spacing: 0.5px;
        text-transform: uppercase;
      "
    >
      ¬© <script>document.write(new Date().getFullYear());</script> Kody Gentry ¬∑ Chum Studios
    </footer>
    <script>
      // Tab switching logic with smooth animations
      document.querySelectorAll('.tabs button').forEach((btn) => {
        btn.addEventListener('click', () => {
          // Update button states
          document.querySelectorAll('.tabs button').forEach((b) => {
            b.classList.remove('active');
            b.setAttribute('aria-selected', 'false');
          });
          btn.classList.add('active');
          btn.setAttribute('aria-selected', 'true');

          // Fade out current content
          const activeContent = document.querySelector('.tab-content.active');
          if (activeContent) {
            activeContent.classList.add('fade-out');
            activeContent.addEventListener(
              'animationend',
              function handler() {
                activeContent.classList.remove('active', 'fade-out');
                activeContent.removeEventListener('animationend', handler);

                // Fade in new content
                const contentId = btn.id.replace('tab', 'content');
                const newContent = document.getElementById(contentId);
                newContent.classList.add('active');
              },
              { once: true }
            );
          } else {
            // If no active content, just show new one
            const contentId = btn.id.replace('tab', 'content');
            document.getElementById(contentId).classList.add('active');
          }
        });
      });

      // Categorization helpers matching the React code logic
      const SIDE_OVERRIDE = new Set([
        'SimpleAPI',
        'Marvel-Rivals-Discord-Stat-Bot',
        'KimoTune',
        'Advent-Of-Code-2023'
      ]);
      const GAME_OVERRIDE = new Set(['DevQuest', 'godot-dot-shader']);
      const SCHOOL_HINTS = [
        'assembly',
        'mips',
        'x86',
        'arm',
        'object oriented',
        'oop',
        'data structures',
        'algorithms',
        'cs',
        'class',
        'assignment',
        'lab',
        'university',
        'college',
        'school',
        'project',
        'semester',
        'spring',
        'fall'
      ];
      const SCHOOL_LANGS = ['C', 'C++', 'Assembly', 'Makefile'];
      function categorizeRepo(r) {
        if (GAME_OVERRIDE.has(r.name)) return 'game';
        if (SIDE_OVERRIDE.has(r.name)) return 'side';
        const name = (r.name || '').toLowerCase();
        const desc = (r.description || '').toLowerCase();
        const lang = r.language || '';
        const hasHint = SCHOOL_HINTS.some((k) => name.includes(k) || desc.includes(k));
        const langHint = SCHOOL_LANGS.includes(lang);
        return hasHint || langHint ? 'school' : 'side';
      }
      async function loadGithubRepos() {
        try {
          const res = await fetch(
            'https://api.github.com/users/kodygentry/repos?per_page=100'
          );
          if (!res.ok) throw new Error('GitHub ' + res.status);
          const data = await res.json();
          const filtered = data.filter((r) => !r.fork);
          const sorted = filtered
            .sort((a, b) => (b.stargazers_count || 0) - (a.stargazers_count || 0))
            .slice(0, 60);
          const categorized = { side: [], school: [], game: [] };
          sorted.forEach((r) => {
            const type = categorizeRepo(r);
            categorized[type].push(r);
          });
          renderRepos('side-projects', categorized.side);
          renderRepos('school-projects', categorized.school);
          renderRepos('game-projects', categorized.game);
        } catch (err) {
          document.getElementById('side-projects').innerHTML =
            '<p>Error loading repos: ' + err.message + '</p>';
        }
      }
      function renderRepos(id, repos) {
        const container = document.getElementById(id);
        container.innerHTML = '';
        if (!repos || repos.length === 0) {
          container.innerHTML =
            '<p class="text-sm text-slate-400">No projects found.</p>';
          return;
        }
        // Highlighted repos for side and school
        const highlightSide = ['KimoTune', 'SimpleAPI', 'Marvel-Rivals-Discord-Stat-Bot'];
        const highlightSchool = [
          'Tic-Tac-Toe-AI',
          'Cardiovascular-Disease-Diagnosis-Expert-System',
          'General-CPP-Programs'
        ];
        let highlightList = [];
        if (id === 'side-projects') highlightList = highlightSide;
        if (id === 'school-projects') highlightList = highlightSchool;
        // Sort so highlights are first, in the order specified
        let sorted = repos.slice();
        if (highlightList.length) {
          const highlights = highlightList
            .map((name) => sorted.find((r) => r.name === name))
            .filter(Boolean);
          const rest = sorted.filter((r) => !highlightList.includes(r.name));
          sorted = [...highlights, ...rest];
        }
        sorted.forEach((r, i) => {
          const isHighlight = highlightList.includes(r.name) && i < 3;
          const div = document.createElement('div');
          div.className = 'project-card' + (isHighlight ? ' project-card-highlight' : '');
          div.innerHTML = `
            <h3>${r.name}</h3>
            <p>${r.description ? r.description : 'No description provided.'}</p>
            <div class="project-meta">
              <span>‚≠ê ${r.stargazers_count || 0}</span>
              <span>üç¥ ${r.forks_count || 0}</span>
              <a href="${r.html_url}" target="_blank" rel="noopener">View on GitHub</a>
            </div>
          `;
          container.appendChild(div);
        });
      }
      async function loadItchGames() {
        // Fallback SVG for controller icon (set before use)
        if (!window.fallbackControllerSVG) {
          window.fallbackControllerSVG = `
            <div style="
              width: 100%;
              height: 120px;
              display: flex;
              align-items: center;
              justify-content: center;
              background: rgba(74, 90, 127, 0.12);
              border-radius: 0.5rem;
              margin-bottom: 0.5rem;
            ">
              <i class='fa-solid fa-gamepad' style="font-size:3rem;color:#a8bce0;"></i>
            </div>`;
        }
        const games = [
          {
            url: 'https://chumstudios.itch.io/midnight-slice-demo',
            title: 'Midnight Slice Demo',
            description: 'A retro horror slice-em-up. Survive the night and slice the monsters!'
          },
          {
            url: 'https://chumstudios.itch.io/eternal-burn',
            title: 'Eternal Burn',
            description: 'A fast-paced endless runner with a fiery twist.'
          }
        ];
        const container = document.getElementById('game-cards');
        container.innerHTML = '';
        for (const game of games) {
          try {
            const res = await fetch(
              'https://itch.io/oembed?url=' + encodeURIComponent(game.url)
            );
            let data = {};
            if (res.ok) {
              data = await res.json();
            }
            const div = document.createElement('div');
            div.className = 'game-card';
            let imgHtml = '';
            if (data.thumbnail_url) {
              imgHtml = `
                <img
                  src="${data.thumbnail_url}"
                  alt="${game.title} cover"
                  style="
                    width: 100%;
                    height: 120px;
                    object-fit: cover;
                    border-radius: 0.5rem;
                    margin-bottom: 0.5rem;
                  "
                  onerror="this.onerror=null;this.outerHTML=window.fallbackControllerSVG;"
                />`;
            } else {
              imgHtml = window.fallbackControllerSVG;
            }
            div.innerHTML = `
              <h3>${game.title}</h3>
              <p>${game.description}</p>
              ${imgHtml}
              <a
                href="${game.url}"
                target="_blank"
                rel="noopener"
                style="color:#c97755;text-decoration:underline;font-size:0.85rem;"
              >
                Play
              </a>
            `;
            container.appendChild(div);
          } catch (err) {
            const div = document.createElement('div');
            div.className = 'game-card';
            div.innerHTML = `
              <h3>${game.title}</h3>
              <p>${game.description}</p>
              ${window.fallbackControllerSVG}
              <a
                href="${game.url}"
                target="_blank"
                rel="noopener"
                style="color:#a8bce0;text-decoration:underline;font-size:0.85rem;"
              >
                Play
              </a>
            `;
            container.appendChild(div);
          }
        }
        // Fallback SVG for controller icon
        if (!window.fallbackControllerSVG) {
          window.fallbackControllerSVG = `
            <svg
              width="100%"
              height="120"
              viewBox="0 0 24 24"
              fill="none"
              stroke="#38bdf8"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              style="
                display:block;
                margin:0 auto 0.5rem auto;
                background:rgba(59,130,246,0.08);
                border-radius:0.5rem;
              "
            >
              <rect x="2" y="7" width="20" height="10" rx="5" />
              <circle cx="7" cy="12" r="1.5" />
              <circle cx="17" cy="12" r="1.5" />
              <path d="M7 12h-2m1-1v2" />
            </svg>`;
        }
      }
      // Initiate data fetches on page load
      loadGithubRepos();
      loadItchGames();
    </script>
    <script>
  // Animate cards as they enter the viewport
  function animateCardsOnScroll() {
    const observer = new window.IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('card-pop-in');
            observer.unobserve(entry.target);
          }
        });
      },
      { threshold: 0.15 }
    );

    document.querySelectorAll('.project-card, .game-card').forEach((card) => {
      observer.observe(card);
    });
  }

  // Re-run after dynamic content loads, but only patch once
  if (!window._cardPopInPatched) {
    window._cardPopInPatched = true;

    const origRenderRepos = window.renderRepos;
    window.renderRepos = function (id, repos) {
      origRenderRepos(id, repos);
      setTimeout(animateCardsOnScroll, 0);
    };

    const origLoadItchGames = window.loadItchGames;
    window.loadItchGames = async function () {
      await origLoadItchGames();
      setTimeout(animateCardsOnScroll, 0);
    };
  }

  // Initial call for cards already in DOM + welcome screen fade out
  window.addEventListener('DOMContentLoaded', () => {
    animateCardsOnScroll();

    // Make loading bar match text width
    const text = document.querySelector('.welcome-text');
    const bar = document.querySelector('.welcome-bar');
    if (text && bar) {
      const width = text.getBoundingClientRect().width;
      bar.style.width = width + 'px';
      bar.style.margin = '0 auto';
    }

    const welcome = document.getElementById('welcome-screen');
    if (welcome) {
      setTimeout(() => {
        // punchy outro
        welcome.classList.add('welcome-out');
        // re-enable scroll
        document.body.classList.remove('no-scroll');
        // remove overlay after animation
        setTimeout(() => {
          if (welcome && welcome.parentNode) {
            welcome.parentNode.removeChild(welcome);
          }
        }, 400); // match CSS transition
      }, 3000); // 3s
    } else {
      document.body.classList.remove('no-scroll');
    }
  });
</script>

